# 2. 아키텍처 개요

## 2.1 네 개의 영역
- `표현 / 응용 / 도메인 / 인프라스트럭쳐`
- 표현: 외부(클라이언트, 이벤트 서비스)의 요청을 받아 응용에 전달
- 응용: 시스템이 사용자에게 제공해야 할 기능을 구현
- 도메인: 시스템의 도메인 모델(=핵심 규칙)을 구현
- 인프라스트럭쳐: 외부 시스템과의 연동, 데이터베이스와의 연동 등

## 2.2 계층 구조 아키텍처
- `표현 -> 응용 -> 도메인 -> 인프라스트럭쳐` 를 계층으로 나눠 구현
- 상위 계층(표현)에서 하위 계층(응용)으로의 의존만 존재
- 중간 단계를 건너 뛰기도 함 (표현 -> 인프라스트럭쳐)
- 하지만 인프라스트럭쳐 계층에 대한 직접 의존은 여러 문제 발생
    - 테스트의 어려움
    - 기능 확장의 어려움
    - 기술 변경의 어려움

## 2.3 DIP
- 의존 역전 원칙
    - `고수준 모듈 -> 저수준 모듈` 의존하는 문제를 해결
    - `저수준 모듈 -> 고수준 모듈`로 만들어줌
- 구현체 위에 고수준의 인터페이스를 두는 방식
    - `고수준 모듈 (의존) -> 인터페이스 <- (구현)`저수준 모듈

## 2.4 도메인 영역의 주요 구성요소
- `엔티티, 밸류, 애그리거트, 리포지터리`
- 엔티티와 밸류는 1장 내용 참고
- 애그리거트: 여러 도메인 모델을 묶은 군집
    - ex) 주문 (상위 개념) - 주문, 배송지 정보, 주문자, 결제 금액 etc
- 리포지터리: 영속성에 대한 처리를 하는 요소

## 2.5 요청 처리 흐름


## 2.6 인프라스트럭처 개요
- 도메인 영역은 인프라 영역에 대한 의존성을 가지지 않지만, 편의성을 포기해서는 안 된다.
    - 적절히 @Transactional을 위한 의존성을 추가하는 것은 좋다.

## 2.7 모듈 구성
- 패키지 구성에 정답은 없음
- 도메인은 각 하위 도메인으로 구성
- 하위 도메인은 애그리거트를 기준으로 구성
- 패키지 크기에 기준은 없지만, 저자 기준으론 10개 ~ 15개가 적절
